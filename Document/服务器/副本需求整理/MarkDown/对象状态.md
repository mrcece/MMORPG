# 一.概述

- 本文档定义对象(PC,NPC)在(联机)副本内的所有状态和标记(Flag)
- 对象在任意时刻总是处在某一状态中
- Flag会影响对象的所有状态

# 二.状态

- Idle(1)
  - 待机(站立)
- Idle_Transition(2)
  - 待机过渡
- Reborn(3)
  - 重生,目前没有使用
- Walk(4)
  - 行走
- Run(5)
  - 跑
- Skill(6)
  - 放技能
- Dead(7)
  - 死亡
- HtLight(8)
  - 原地受击
- HtKnockBack(9)
  - 击退
- HtKnockDown(10)
  - 击倒
- HtFly(11)
  - 击飞
- Parry(12)
  - 被格挡反击
- EnterLeaveFight(13)
  - 进入/离开战斗
- Paralysis(14)
  - 瘫痪,NPC被破霸体
- 大型NPC动作    <==    待新增!
  - 倒地,起身,转向

# 三.Flag
- 霸体
  - 受击不做受击表现,但是有伤害
- 控制(冰冻,束缚...)
  - 动作暂停,原位移继续
  - 不能移动,不能放技能
  - 受击不做受击表现,但是有伤害
  - Aura/Buff继续运作
  - Flag结束后,回到Idle
    - 如果倒地,先起身,后Idle
  - 血量到0,先等Flag结束,再切到Dead
- 无敌
  - 有益的效果,可作用
    - 治疗技能,会播受击表现,有治疗效果
    - 可受有益的Aura影响
    - 可加Buff
  - 有害的效果,不受影响
    - (伤害)技能,不做受击表现,也无伤害
    - 不受有害的Aura影响
    - 不能加DeBuff
    - 已存在的DeBuff不起作用
- 时间静止
  - 动作暂停,位移也暂停
  - 不能移动,不能放技能
  - 受击不做受击表现,但是有伤害
  - Aura/Buff继续运作
  - Flag结束后,继续原动作,继续原位移
  - 血量到0,先等Flag结束,再切到Dead
- Flag权重和抑制
  - 对象身上可以同时存在多个相同/不同Flag
  - Flag有权重,权重高的起作用,权重低的被抑制
  - 权重高的Flag结束后,如果权重低的Flag还在,则权重低的Flag开始起作用
  - Flag的权重为: 时间静止>无敌>被控制>霸体

# 三.状态切换

- 一般切换规则
  - 没有按键/AI输入时,切到Idle
  - 移动时,切到Walk/Run
  - 发技能时,切到Skill
  - 受击时,根据受击表现,切到HtLight/HtKnockBack/HtKnockDown/HtFly/Parry
  - 血量=0时,切到Dead
- 各种受击表现切换
  - 详见SkillOnHit表
- Paralysis切换
  - NPC霸体值被减完时,切到Paralysis
  - NPC霸体值回复后,切到Idle

# 四.特别说明

- 被击飞中,放"破受击硬直"的技能,在空中播技能,加自由落体